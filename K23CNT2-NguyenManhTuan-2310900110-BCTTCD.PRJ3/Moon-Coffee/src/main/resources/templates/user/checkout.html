<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>Thanh Toán - Moon Coffee</title>
    <link href="https://fonts.googleapis.com/css2?family=Nunito:wght@400;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        body { font-family: 'Nunito', sans-serif; background: #f4f6f8; padding: 20px; }
        .container { max-width: 1000px; margin: 0 auto; display: grid; grid-template-columns: 1.5fr 1fr; gap: 30px; }

        .form-section { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.05); }
        h2 { margin-bottom: 20px; color: #0f2c38; border-bottom: 2px solid #eee; padding-bottom: 10px; }
        .form-group { margin-bottom: 15px; }
        .form-group label { display: block; margin-bottom: 5px; font-weight: bold; color: #555; }
        .form-group input, .form-group textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 6px; box-sizing: border-box; font-family: inherit; }

        /* Phương thức thanh toán */
        .payment-methods { margin-top: 25px; border-top: 1px solid #eee; padding-top: 20px; }
        .method-item {
            display: flex; align-items: center; gap: 15px;
            padding: 15px; border: 1px solid #ddd; border-radius: 8px;
            margin-bottom: 12px; cursor: pointer; transition: 0.3s;
        }
        /* Hiệu ứng khi di chuột và khi được chọn */
        .method-item:hover { background: #fdfaf3; border-color: #c5a065; }
        .method-item input[type="radio"]:checked + i,
        .method-item input[type="radio"]:checked + img + span { font-weight: bold; }

        /* Cột tóm tắt đơn hàng */
        .summary-section { background: #0f2c38; color: white; padding: 30px; border-radius: 10px; height: fit-content; position: sticky; top: 20px; }
        .summary-item { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 15px; }
        .total-row { font-size: 22px; font-weight: bold; color: #c5a065; border-top: 2px dashed rgba(255,255,255,0.3); padding-top: 20px; margin-top: 15px; display: flex; justify-content: space-between; }

        .btn-confirm { background: #c5a065; color: #0f2c38; width: 100%; padding: 18px; border: none; font-weight: bold; font-size: 16px; border-radius: 6px; cursor: pointer; margin-top: 25px; text-transform: uppercase; transition: 0.3s; box-shadow: 0 4px 10px rgba(197, 160, 101, 0.3); }
        .btn-confirm:hover { background: white; transform: translateY(-3px); box-shadow: 0 6px 15px rgba(0,0,0,0.2); }

        .discount-text { color: #2ecc71; font-weight: bold; }
        .item-list { margin-bottom: 20px; max-height: 250px; overflow-y: auto; padding-right: 10px; }
        /* Thanh cuộn cho danh sách món ăn */
        .item-list::-webkit-scrollbar { width: 4px; }
        .item-list::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 10px; }
    </style>
</head>
<body>

<form th:action="@{/checkout}" method="post" class="container">

    <div class="form-section">
        <h2><i class="fas fa-shipping-fast"></i> Thông Tin Giao Hàng</h2>

        <div class="form-group">
            <label>Họ và tên (*)</label>
            <input type="text" name="customerName" required placeholder="Nhập tên của bạn">
        </div>

        <div class="form-group">
            <label>Số điện thoại (*)</label>
            <input type="text" name="customerPhone" required placeholder="Shipper sẽ gọi số này">
        </div>

        <div class="form-group">
            <label>Địa chỉ nhận hàng (*)</label>
            <input type="text" name="customerAddress" required placeholder="Số nhà, đường, phường, quận...">
        </div>

        <div class="form-group">
            <label>Ghi chú (Tùy chọn)</label>
            <textarea name="note" rows="2" placeholder="Ví dụ: Ít đá, nhiều sữa..."></textarea>
        </div>

        <div class="payment-methods">
            <label style="font-weight: bold; color: #0f2c38; display: block; margin-bottom: 15px;">Phương thức thanh toán (*)</label>

            <label class="method-item">
                <input type="radio" name="paymentMethod" value="COD" checked>
                <i class="fas fa-money-bill-wave" style="color: #27ae60; width: 24px; text-align: center;"></i>
                <span>Thanh toán khi nhận hàng (COD)</span>
            </label>

            <label class="method-item">
                <input type="radio" name="paymentMethod" value="TRANSFER">
                <i class="fas fa-university" style="color: #2980b9; width: 24px; text-align: center;"></i>
                <span>Chuyển khoản VietQR (MB Bank)</span>
            </label>

            <label class="method-item">
                <input type="radio" name="paymentMethod" value="MOMO">
                <img th:src="@{/images/products/iconmomo.png}" alt="MoMo" style="width: 24px; height: 24px; border-radius: 4px;">
                <span>Ví điện tử MoMo</span>
            </label>
        </div>

        <div style="margin-top: 25px;">
            <a th:href="@{/cart}" style="color: #666; text-decoration: none; font-size: 14px;"><i class="fas fa-arrow-left"></i> Quay lại giỏ hàng</a>
        </div>
    </div>

    <div class="summary-section">
        <h2 style="color: white; border-color: rgba(255,255,255,0.2);">Tóm Tắt Đơn Hàng</h2>

        <div class="item-list">
            <div th:each="item : ${cartItems}" class="summary-item">
                <span th:text="${item.name} + ' (x' + ${item.quantity} + ')'">Sản phẩm</span>
                <span th:text="${#numbers.formatDecimal(item.price * item.quantity, 0, 'POINT', 0, 'POINT')} + ' đ'">0 đ</span>
            </div>
        </div>

        <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 15px;">
            <div class="summary-item">
                <span>Tạm tính:</span>
                <span th:text="${#numbers.formatDecimal(subtotal, 0, 'POINT', 0, 'POINT')} + ' đ'">0 đ</span>
            </div>

            <div class="summary-item" th:if="${discount > 0}">
                <span>Giảm giá:</span>
                <span class="discount-text" th:text="'- ' + ${#numbers.formatDecimal(discount, 0, 'POINT', 0, 'POINT')} + ' đ'">- 0 đ</span>
            </div>

            <div class="total-row">
                <span>TỔNG CỘNG:</span>
                <span th:text="${#numbers.formatDecimal(totalPrice, 0, 'POINT', 0, 'POINT')} + ' đ'">0 đ</span>
            </div>
        </div>

        <button type="submit" class="btn-confirm">XÁC NHẬN ĐẶT HÀNG</button>
    </div>

</form>

</body>
</html>